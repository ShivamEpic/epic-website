<!DOCTYPE html>
<html>
<head>
  <title>Product</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="product"></div>

<script src="products.js"></script>
<script>
const params = new URLSearchParams(window.location.search);
const id = parseInt(params.get("id"));
const product = products.find(p => p.id === id);

let discount = 0;

document.getElementById("product").innerHTML = `
  <div class="card">
    <img src="${product.image}">
    <h2>${product.name}</h2>
    <p>${product.description}</p>

    <h3 id="price">Price: ₹${product.price}</h3>

    <input id="coupon" placeholder="Enter coupon code">
    <button onclick="applyCoupon()">Apply Coupon</button>

    <p id="discount"></p>

    <button onclick="buyNow()">Buy Now</button>
  </div>
`;

function applyCoupon() {
  const code = document.getElementById("coupon").value.toUpperCase();

  if (code === "EPIC10") discount = product.price * 0.1;
  else if (code === "WELCOME50") discount = 50;
  else {
    alert("Invalid coupon");
    return;
  }

  document.getElementById("discount").innerText =
    "Discount: -₹" + discount;

  document.getElementById("price").innerText =
    "Final Price: ₹" + (product.price - discount);
}

function buyNow() {
  const cart = [{
    ...product,
    qty: 1,
    finalPrice: product.price - discount
  }];

  localStorage.setItem("cart", JSON.stringify(cart));
  window.location.href = "checkout.html";
}
</script>

</body>
</html>
